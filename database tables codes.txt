-- Table: Role
CREATE TABLE Role (
    role_id INT AUTO_INCREMENT PRIMARY KEY,
    role_name VARCHAR(30) NOT NULL
);

-- Table: User
CREATE TABLE User (
    user_id INT AUTO_INCREMENT PRIMARY KEY,
    fname VARCHAR(15) NOT NULL,
    lname VARCHAR(15) NOT NULL,
    email VARCHAR(30) UNIQUE NOT NULL,
    password VARCHAR(15) NOT NULL,
    phone_no VARCHAR(15) UNIQUE NOT NULL,
    address VARCHAR(50),
    role_id INT,
    account_status VARCHAR(15),
    FOREIGN KEY (role_id) REFERENCES Role(role_id)
);

-- Table: Tour_Package
CREATE TABLE Tour_Package (
    tour_package_id INT AUTO_INCREMENT PRIMARY KEY,
    tour_name VARCHAR(30) NOT NULL,
    description VARCHAR(250),
    price DOUBLE CHECK (price > 0),
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    duration INT CHECK (duration > 0),
    no_of_seats INT CHECK (no_of_seats > 0),
    adhar_no(varchar 12),
    mgr_id INT,
    guide_id INT,
    FOREIGN KEY (mgr_id) REFERENCES User(user_id),
    FOREIGN KEY (guide_id) REFERENCES User(user_id)
);

-- Table: Tour_Transaction
CREATE TABLE Tour_Transaction (
    tour_transaction_id INT AUTO_INCREMENT PRIMARY KEY,
    status VARCHAR(30) NOT NULL,
    booking_date DATE NOT NULL,
    user_id INT,
    tour_package_id INT,
    FOREIGN KEY (user_id) REFERENCES User(user_id),
    FOREIGN KEY (tour_package_id) REFERENCES Tour_Package(tour_package_id)
);

-- Table: Tour_Payment
CREATE TABLE Tour_Payment (
    payment_id INT AUTO_INCREMENT PRIMARY KEY,
    tour_transaction_id INT,
    amount DOUBLE CHECK (amount > 0),
    payment_date DATE NOT NULL,
    payment_mode VARCHAR(15) NOT NULL,
    FOREIGN KEY (tour_transaction_id) REFERENCES Tour_Transaction(tour_transaction_id)
);

-- Table: Tour_Image
CREATE TABLE Tour_Image (
    image_id INT AUTO_INCREMENT PRIMARY KEY,
    tp_id INT,
    image_url MEDIUMTEXT,
    FOREIGN KEY (tp_id) REFERENCES Tour_Package(tour_package_id)
);

-- Table: Tour_Member
CREATE TABLE Tour_Member (
    member_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT,
    tt_id INT,
    fname VARCHAR(15) NOT NULL,
    lname VARCHAR(15) NOT NULL,
    adhar_no VARCHAR(15) NOT NULL,
    FOREIGN KEY (user_id) REFERENCES User(user_id),
    FOREIGN KEY (tt_id) REFERENCES Tour_Transaction(tour_transaction_id)
);
